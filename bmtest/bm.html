<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BM 진단 대시보드 (질문상세)</title>
    <style>
        /* --- 스타일 (기존 유지 + 텍스트 줄바꿈 수정) --- */
        :root { --primary: #2563eb; --bg: #f1f5f9; --text: #334155; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: "Pretendard", -apple-system, BlinkMacSystemFont, "Malgun Gothic", sans-serif;
            background-color: var(--bg); color: var(--text); 
            height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden;
        }
        .dashboard {
            width: 100%; max-width: 1400px; height: 95vh; background: #fff;
            border-radius: 16px; box-shadow: 0 20px 50px rgba(0,0,0,0.1);
            display: flex; overflow: hidden; border: 1px solid #e2e8f0;
        }
        /* 사이드바 */
        .sidebar { width: 280px; background: #1e293b; color: #fff; display: flex; flex-direction: column; }
        .sidebar-header { padding: 24px; background: #0f172a; border-bottom: 1px solid #334155; }
        .sidebar-header h1 { font-size: 1.2rem; font-weight: 700; margin-bottom: 4px; }
        .sidebar-header p { font-size: 0.8rem; color: #94a3b8; }
        .company-list { flex: 1; overflow-y: auto; list-style: none; }
        .company-item { padding: 18px 24px; cursor: pointer; border-bottom: 1px solid #334155; transition: 0.2s; }
        .company-item:hover { background: #334155; }
        .company-item.active { background: var(--primary); border-left: 6px solid #93c5fd; }
        .c-name { display: block; font-weight: 600; font-size: 1rem; margin-bottom: 4px; }
        .c-ceo { display: block; font-size: 0.85rem; color: #cbd5e1; }
        
        /* 메인 */
        .main { flex: 1; display: flex; flex-direction: column; background: #f8fafc; overflow: hidden; }
        .header { background: #fff; padding: 20px 32px; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; }
        .header h2 { font-size: 1.6rem; font-weight: 800; color: #1e293b; display: flex; align-items: center; gap: 12px; }
        .badge { font-size: 0.9rem; padding: 4px 12px; border-radius: 20px; background: #eff6ff; color: var(--primary); border: 1px solid #bfdbfe; }
        .header-info { display: flex; gap: 24px; font-size: 0.95rem; color: #64748b; font-weight: 500; }
        
        .content-body { flex: 1; overflow-y: auto; padding: 32px; }
        .card { background: #fff; border-radius: 12px; padding: 24px; box-shadow: 0 2px 4px rgba(0,0,0,0.03); border: 1px solid #e2e8f0; margin-bottom: 24px; }
        .card-header { font-size: 1.1rem; font-weight: 700; margin-bottom: 16px; display: flex; align-items: center; gap: 8px; padding-bottom: 12px; border-bottom: 2px solid #f1f5f9; }
        
        .qualitative-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 24px; }
        .text-content { background: #f8fafc; padding: 20px; border-radius: 8px; font-size: 0.95rem; line-height: 1.65; color: #475569; white-space: pre-line; min-height: 140px; }
        .border-red { border: 1px solid #fee2e2; background: #fef2f2; color: #334155; }
        .border-amber { border: 1px solid #fef3c7; background: #fffbeb; color: #334155; }
        .text-red { color: #dc2626; } .text-amber { color: #d97706; }
        
        .chart-container { display: flex; gap: 40px; align-items: flex-start; }
        .radar-wrapper { width: 360px; flex-shrink: 0; display: flex; flex-direction: column; align-items: center; padding: 10px; background: #fafafa; border-radius: 12px; }
        .bar-list-wrapper { flex: 1; }
        
        /* 차트 스타일 */
        .radar-web { stroke: #e2e8f0; stroke-width: 1; fill: none; }
        .radar-axis { stroke: #cbd5e1; stroke-width: 1; }
        .radar-area { fill: rgba(37, 99, 235, 0.25); stroke: #2563eb; stroke-width: 2.5; }
        .radar-label { font-size: 13px; fill: #64748b; font-weight: 600; text-anchor: middle; dominant-baseline: middle; }
        
        .bar-category { margin-bottom: 24px; }
        .bar-cat-header { display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 0.95rem; font-weight: 700; color: #334155; border-bottom: 1px solid #f1f5f9; padding-bottom: 8px;}
        
        /* 질문 텍스트 스타일 수정 (줄바꿈 허용) */
        .bar-row { display: flex; align-items: center; margin-bottom: 12px; font-size: 0.85rem; }
        .q-text { 
            flex: 1; 
            color: #64748b; 
            padding-right: 12px; 
            white-space: normal; /* 줄바꿈 허용 */
            word-break: keep-all; /* 단어 단위 줄바꿈 */
            line-height: 1.4;
        }
        .bar-bg { width: 100px; height: 8px; background: #e2e8f0; border-radius: 4px; overflow: hidden; flex-shrink: 0; }
        .bar-fill { height: 100%; border-radius: 4px; transition: width 0.3s; }
        .q-score { width: 24px; text-align: right; font-weight: 700; margin-left: 8px; flex-shrink: 0; }
        
        /* 아이콘 */
        .icon { width: 20px; height: 20px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
    </style>
</head>
<body>

<div class="dashboard">
    <aside class="sidebar">
        <div class="sidebar-header">
            <h1>BM 진단 결과</h1>
            <p>창업중심대학 멘토링 자료</p>
        </div>
        <!-- 목록이 자바스크립트로 채워집니다 -->
        <ul class="company-list" id="companyList">
        </ul>
    </aside>

    <main class="main">
        <header class="header">
            <div class="header-left">
                <h2 id="uiName">데이터 로딩중...</h2>
            </div>
            <div class="header-info">
                <div style="display:flex; gap:8px;">
                    <svg class="icon" viewBox="0 0 24 24"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
                    <span id="uiPhone"></span>
                </div>
                <div style="display:flex; gap:8px;">
                    <svg class="icon" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                    <span id="uiDate"></span>
                </div>
            </div>
        </header>

        <div class="content-body">
            <div class="qualitative-grid">
                <div class="card" style="margin-bottom: 0;">
                    <div class="card-header text-red">
                        <svg class="icon" viewBox="0 0 24 24" style="color:#dc2626"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                        핵심 애로사항 (Pain Point)
                    </div>
                    <div class="text-content border-red" id="uiIssues"></div>
                </div>
                <div class="card" style="margin-bottom: 0;">
                    <div class="card-header text-amber">
                        <svg class="icon" viewBox="0 0 24 24" style="color:#d97706"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>
                        사업비 집행 우려사항
                    </div>
                    <div class="text-content border-amber" id="uiSpending"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-header" style="color: #334155;">
                    <svg class="icon" viewBox="0 0 24 24" style="color: var(--primary);"><path d="M21.21 15.89A10 10 0 1 1 8 2.83"></path><path d="M22 12A10 10 0 0 0 12 2v10z"></path></svg>
                    BM 5대 영역 진단 결과
                </div>
                
                <div class="chart-container">
                    <div class="radar-wrapper">
                        <h4 style="margin-bottom: 16px; font-size: 0.9rem; color: #64748b;">영역별 밸런스 진단</h4>
                        <svg width="300" height="300" viewBox="0 0 300 300" id="radarSvg">
                        </svg>
                    </div>
                    <div class="bar-list-wrapper" id="barContainer">
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<script>
(function() {
    // --- 실데이터 베이스 (관리자님 제공) ---
    const DB = [
        {
            id: 1, name: "Agitho", ceo: "곽현우", phone: "010-4621-1901", date: "12월 초",
            issues: "드론으로 하는 창업이다보니 초기비용이 많이 들고 시장을 개척해나가야 하는 상황에서 컨설팅이 필요하다",
            spending: "드론 사업의 특성상 사업비로 활용할 수 있는 부분이 제한적이라 아쉽다.",
            scores: { c: [5,5,5], m: [2,1,5,2,5], p: [3,1,5,5,5], k: [3,2,2,2,4], v: [5,5,3,3] }
        },
        {
            id: 2, name: "고에어", ceo: "곽범신", phone: "010-9902-0315", date: "12월 초",
            issues: "MVP 테스트를 위한 정부, 공공기관 등 협업이 필요합니다.",
            spending: "특이사항 없습니다.",
            scores: { c: [4,4,4], m: [4,3,4,2,5], p: [3,4,3,4,3], k: [4,3,4,3,4], v: [4,3,4,3] }
        },
        {
            id: 3, name: "진주도원", ceo: "홍성권", phone: "010-9491-0746", date: "출원 완료",
            issues: "판로 개척",
            spending: "일정이 너무 빠듯할 것 같다. 생산이 그때까지 완료될지 모르곘다",
            scores: { c: [4,4,4], m: [4,3,4,4,4], p: [4,4,4,4,4], k: [4,4,4,4,4], v: [4,4,4,4] }
        },
        {
            id: 4, name: "Nooa", ceo: "김지현", phone: "010-9674-4999", date: "12월 말",
            issues: "창업 아이템 기술의 고도화 과정이 필요한데 기술 개발을 어디서 누구에게 맡기면 좋을지 정보가 필요합니다",
            spending: "아직은 없습니다",
            scores: { c: [3,4,5], m: [5,5,4,4,4], p: [3,5,4,4,4], k: [1,1,2,4,3], v: [3,4,4,4] }
        },
        {
            id: 5, name: "도담팜", ceo: "조상규", phone: "010-8758-6224", date: "12월 초",
            issues: "사업자를 낼 때 세부업종, 업태 분류가 많아 쉽게 접근하기 힘들다. 숫자 하나 차이로 간이사업자가 될수도, 일반 사업자가 되기도 한다.",
            spending: "돈을 사용하려면 구매처가 사업자를 가지고 있어야 한다는 것. 돈의 출처를 명확히 하기 위함은 이해하지만 창업 아이템 특성 상 농민에게 농산물을 구매해서 지역경제활성화를 도모한다는 계획이 포함되어 있는 입장으로서 농민이 사업자를 가진 곳이 흔치않아 불편함이 있습니다.",
            scores: { c: [4,3,3], m: [4,4,3,3,3], p: [3,4,4,3,3], k: [4,4,4,4,4], v: [4,4,4,4] }
        },
        {
            id: 6, name: "십지공방", ceo: "이창기", phone: "010-8665-8342", date: "12월 초",
            issues: "옥원석 을 구하는게 쉽지않습니다 ㅠ 그리고 kc 인증 관련 법적 자문도 구하고싶습니다",
            spending: "옥 구입처가 해외라 걱정입니다",
            scores: { c: [5,5,5], m: [1,1,4,3,3], p: [3,3,3,3,5], k: [3,1,1,3,3], v: [5,5,3,3] }
        },
        {
            id: 7, name: "루미브루", ceo: "지영민", phone: "010-5607-1915", date: "11월 말",
            issues: "1. 현재 겪고 있는 창업 단계에서의 핵심 문제 혹은 애로 사항\n\n현재 저는 초기 자본이 부족해 제품의 초기 생산분(초기 물량)을 확보하기 어려운 상황입니다. 이로 인해 정부지원사업을 통해 초기 비용을 지원받고 싶지만, 어디서부터 어떻게 준비해야 할지 막막함을 느끼고 있습니다.\n\n또한 제 아이템이 분명 매력적이고 가능성이 있다고 생각하지만, 실제 시장에서 소비자들에게 통할지, 그리고 다른 브랜드들과의 차별점을 고객들이 명확히 느낄 수 있을지에 대한 고민이 큽니다.\n시장 검증과 브랜드 포지셔닝 측면에서 확신이 부족한 것이 현재 가장 큰 애로 사항입니다.",
            spending: "2. OT를 듣고 난 후, 사업비 집행 시 예상되는 문제점\n\n사업비 집행 시 홍보·마케팅 전략에서의 어려움이 예상됩니다. 당초 인플루언서 협업이나 SNS 기반 홍보를 고려했지만, 해당 방식은 외주 용역으로 분류되지 않아 사업비로 집행하기 어렵다는 설명을 들으며 홍보 방향 설정이 다시 어려워졌습니다.\n\n또한 촬영용 휴대폰과 카메라를 사업비로 구매해 SNS 콘텐츠 중심의 마케팅을 적극적으로 진행하려는 계획이 있었으나, 이것 역시 집행이 쉽지 않다는 안내를 받아 현실적인 마케팅 실행 전략을 다시 세워야 하는 상황입니다.",
            scores: { c: [5,3,5], m: [2,3,3,3,3], p: [4,2,1,2,4], k: [2,2,1,4,3], v: [3,3,4,4] }
        },
        {
            id: 8, name: "Carestation", ceo: "정종원", phone: "010-3399-0842", date: "12월 말",
            issues: "직장을 다니면서 창업하기가 어렵다.\n지원사업이 교육이 대부분 평일에 잡혀있다.",
            spending: "시간이 많이 촉박하다.",
            scores: { c: [5,4,3], m: [3,2,5,4,3], p: [2,4,2,3,5], k: [4,4,4,4,4], v: [3,4,4,3] }
        },
        {
            id: 9, name: "고랄로보틱스", ceo: "차준호", phone: "010-5450-9828", date: "12월 말",
            issues: "지금 우리가 팀이 보유하고 있는 역량을 잘 활용해서 캐시 카우가 될 비즈니스 모델을 만들어줄 CEO가 필요 합니다.",
            spending: "매주 월요일에 물품 구매가 가능하다는 것이 힘듭니다..",
            scores: { c: [1,3,3], m: [3,5,3,3,5], p: [5,3,3,3,1], k: [3,1,1,1,3], v: [5,5,5,5] }
        },
        {
            id: 10, name: "소하아뜰리에", ceo: "임서진", phone: "010-9807-5090", date: "11월 5일",
            issues: "타겟시장 제안 방법 및 경쟁사 분석 방안",
            spending: "없음",
            scores: { c: [3,2,5], m: [3,3,2,2,3], p: [2,5,4,2,2], k: [3,2,2,4,3], v: [3,3,3,3] }
        }
    ];

    // --- 메타 데이터 (질문 전체 삽입) ---
    const META = {
        c: { 
            title: "고객 (Customer)", 
            q: [
                "1. 우리 목표 고객은 명확하게 정의되어 있다.",
                "2. 우리 제품/서비스는 고객이 겪고 있는 문제를 해결할 수 있다.",
                "3. 우리는 고객유지 및 유치를 위해 모바일, SNS 등을 활용할 것이다."
            ] 
        },
        m: { 
            title: "시장성 (Market)", 
            q: [
                "1. 우리 목표시장에는 경쟁자가 명확히 존재한다.",
                "2. 우리 목표시장은 경쟁이 치열하다.",
                "3. 우리 사업은 정책 및 제도의 적극적인 지원을 받을 수 있다.",
                "4. 우리 사업은 제도적인 장벽으로 보호받는다.",
                "5. 우리 사업은 미래산업 측면에서 수요가 증가하고 있다."
            ] 
        },
        p: { 
            title: "수익모델 (Profit)", 
            q: [
                "1. 우리 사업의 기술개발 비용은 우리가 감당할만한 수준으로 보인다.",
                "2. 우리 사업은 고객 유지 및 유치를 위해 많은 비용이 발생할 것으로 보인다.",
                "3. 우리 사업 방식은 시장상황에 따라 변동성이 높은 편이다.",
                "4. 우리 사업은 경쟁사에 비해 가격경쟁에서 우위에 있다.",
                "5. 우리 사업의 수익원은 향후 3년 이상 지속가능하다."
            ] 
        },
        k: { 
            title: "핵심역량 (Core)", 
            q: [
                "1. 우리 기술(제품)은 경쟁사가 모방하기 어렵다.",
                "2. 우리는 제품개발을 위해 충분한 연구시설이나 최신 장비를 보유하고 있다.",
                "3. (재무) 우리는 사업에 필요한 자금조달이 용이한 편이다.",
                "4. (마케팅) 우리는 시장 개척을 위한 경험과 능력을 보유하고 있다.",
                "5. 우리 대표는 내부와 외부의 인적 네트워킹이 탁월하다."
            ] 
        },
        v: { 
            title: "가치제안 (Value)", 
            q: [
                "1. 우리는 자사의 ‘가치 제안’을 명확히 이해하고 있다.",
                "2. 우리의 ‘가치 제안’은 경쟁사와 비교하여 차별화 요소가 있다.",
                "3. 우리 제품/서비스는 고객이 원하는 품질의 기능을 제공하고 있다.",
                "4. 우리는 다양한 디자인과 품목의 제품/서비스를 제공하고 있다."
            ] 
        }
    };

    // --- 함수 정의 (window에 부착하여 전역 접근 보장) ---
    window.initDashboard = function() {
        const list = document.getElementById('companyList');
        list.innerHTML = "";
        DB.forEach((comp, idx) => {
            const li = document.createElement('li');
            li.className = 'company-item' + (idx === 0 ? ' active' : '');
            li.setAttribute('data-id', comp.id);
            li.innerHTML = `
                <span class="c-name">${comp.name}</span>
                <span class="c-ceo">${comp.ceo} 대표</span>
            `;
            // 안전한 이벤트 리스너 방식 사용
            li.addEventListener('click', function() {
                window.loadCompany(comp.id, this);
            });
            list.appendChild(li);
        });

        // 초기 실행: 첫 번째 기업 데이터 로드
        window.loadCompany(DB[0].id, list.firstChild);
    };

    window.loadCompany = function(id, element) {
        // 사이드바 활성화 업데이트
        const listItems = document.querySelectorAll('.company-item');
        listItems.forEach(li => li.classList.remove('active'));
        if(element) element.classList.add('active');

        const data = DB.find(d => d.id === id);
        if (!data) return;

        // 텍스트 업데이트
        document.getElementById('uiName').innerHTML = `${data.name} <span class="badge" style="font-size:0.9rem; padding:4px 12px; border-radius:20px; background:#eff6ff; color:#2563eb; border:1px solid #bfdbfe;">${data.ceo} 대표</span>`;
        document.getElementById('uiPhone').innerText = data.phone;
        document.getElementById('uiDate').innerText = "창업예정: " + data.date;
        document.getElementById('uiIssues').innerText = data.issues;
        document.getElementById('uiSpending').innerText = data.spending;

        // 차트 그리기
        drawSvgRadar(data.scores);
        drawBars(data.scores);
    };

    function drawSvgRadar(scores) {
        const svg = document.getElementById('radarSvg');
        if(!svg) return;
        svg.innerHTML = ""; 

        const centerX = 150, centerY = 150, radius = 100;
        const keys = ['c', 'm', 'p', 'k', 'v'];
        const labels = ["고객", "시장", "수익", "역량", "가치"];
        
        // 배경망
        for (let r = 1; r <= 5; r++) {
            const points = [];
            for (let i = 0; i < 5; i++) {
                const angle = (Math.PI * 2 * i) / 5 - Math.PI / 2;
                const dist = (radius / 5) * r;
                points.push(`${centerX + Math.cos(angle) * dist},${centerY + Math.sin(angle) * dist}`);
            }
            const poly = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
            poly.setAttribute("points", points.join(" "));
            poly.setAttribute("class", "radar-web");
            svg.appendChild(poly);
        }

        // 축과 라벨
        for (let i = 0; i < 5; i++) {
            const angle = (Math.PI * 2 * i) / 5 - Math.PI / 2;
            const x = centerX + Math.cos(angle) * radius;
            const y = centerY + Math.sin(angle) * radius;
            const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
            line.setAttribute("x1", centerX); line.setAttribute("y1", centerY); line.setAttribute("x2", x); line.setAttribute("y2", y);
            line.setAttribute("class", "radar-axis");
            svg.appendChild(line);
            
            const lx = centerX + Math.cos(angle) * (radius + 20);
            const ly = centerY + Math.sin(angle) * (radius + 20);
            const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
            text.setAttribute("x", lx); text.setAttribute("y", ly);
            text.setAttribute("class", "radar-label");
            text.textContent = labels[i];
            svg.appendChild(text);
        }

        // 데이터 그리기
        const dataPoints = [];
        keys.forEach((k, i) => {
            const arr = scores[k];
            const avg = arr.reduce((a,b)=>a+b,0) / arr.length;
            const angle = (Math.PI * 2 * i) / 5 - Math.PI / 2;
            const dist = (radius / 5) * avg;
            dataPoints.push(`${centerX + Math.cos(angle) * dist},${centerY + Math.sin(angle) * dist}`);
        });
        const polyData = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
        polyData.setAttribute("points", dataPoints.join(" "));
        polyData.setAttribute("class", "radar-area");
        svg.appendChild(polyData);
    }

    function drawBars(scores) {
        const container = document.getElementById('barContainer');
        if(!container) return;
        container.innerHTML = "";
        
        const keys = ['c', 'm', 'p', 'k', 'v'];
        keys.forEach(k => {
            const meta = META[k];
            const arr = scores[k];
            const avg = (arr.reduce((a,b)=>a+b,0) / arr.length).toFixed(1);
            let color = avg >= 4 ? "#22c55e" : (avg <= 2.5 ? "#ef4444" : "#3b82f6");

            let html = `<div class="bar-category">
                <div class="bar-cat-header"><span>${meta.title}</span><span style="color:${color}">${avg} / 5.0</span></div>`;
            
            arr.forEach((score, idx) => {
                const pct = (score / 5) * 100;
                let barColor = score >= 4 ? "#22c55e" : (score <= 2 ? "#ef4444" : "#3b82f6");
                html += `<div class="bar-row"><span class="q-text">${meta.q[idx]}</span>
                    <div class="bar-bg"><div class="bar-fill" style="width:${pct}%; background-color:${barColor}"></div></div>
                    <span class="q-score" style="color:${barColor}">${score}</span></div>`;
            });
            html += `</div>`;
            container.innerHTML += html;
        });
    }

    // 실행
    window.initDashboard();

})();
</script>
</body>
</html>
